{"version":3,"file":"component---src-pages-index-tsx-10a1856b011042d82a78.js","mappings":"8KA4BA,MApBiC,EAAGA,MAAAA,EAAQ,EAAGC,OAAAA,KAY3C,uBAAKC,UCnBY,kCDoBf,0BAAQA,UCnBe,yCDmBoBC,QAZ7B,KACZH,GAAS,GAGbC,EAAOD,EAAQ,MASb,wBAAME,UClBO,gCDkBmBF,GAChC,0BAAQE,UCpBe,yCDoBoBC,QAR7B,KAChBF,EAAOD,EAAQ,OEmBnB,MAxB0C,EAAGI,KAAAA,EAAMH,OAAAA,EAAQI,OAAAA,KAEvD,uBAAKH,UCZqB,oDDaxB,yBACEA,UCbW,wCDcXI,aAAcF,EAAKG,MACnBC,YAAa,SACbC,QAASC,IACPT,EAAO,IAAKG,EAAMG,MAAOG,EAAEC,cAAcX,WAG7C,uBAAKE,UCnBa,8CDoBhB,gBAAC,EAAD,CACEF,MAAOI,EAAKJ,MACZC,OAAQD,IACNC,EAAO,IAAKG,EAAMJ,MAAAA,QAIxB,0BAAQE,UC1BW,8CD0BoBC,QAAS,IAAME,OEfrD,MAAMO,GAA0BC,EAAAA,EAAAA,eAAgC,CACrEC,KAAM,IAAM,KACZC,KAAM,SCfFC,EAAiB,eAEVC,EAAqC,CAChDH,KAAM,KACJ,GAA4B,oBAAjBI,aACT,OAAO,KAGT,MAAMC,EAAcD,aAAaE,QAAQJ,GACzC,OAAKG,EAGEE,KAAKC,MAAMH,GAFT,MAIXJ,KAAOI,IACuB,oBAAjBD,cAIXA,aAAaK,QAAQP,EAAgBK,KAAKG,UAAUL,MCpBjD,I,oBC4BP,MAAMM,EAAU,CAACC,EAAuBC,KACtC,IAAIC,EACJ,OAAQD,EAAOE,MACb,IAAK,OACH,OAAOF,EAAOG,MAEhB,IAAK,SAGH,OAFAF,EAAW,IAAIF,EAAOC,EAAOvB,MAC7Ba,EAAiBF,KAAKa,GACfA,EAET,IAAK,SAIH,OAHAA,EAAW,IAAIF,GACfE,EAASD,EAAOI,OAASJ,EAAOvB,KAChCa,EAAiBF,KAAKa,GACfA,EAET,IAAK,SAGH,OAFAA,EAAWF,EAAMM,QAAO,CAACC,EAAGC,IAAMA,IAAMP,EAAOI,QAC/Cd,EAAiBF,KAAKa,GACfA,EAET,QAEE,OADiBD,IAoDvB,MA/CuC,KACrC,MAAM,EAACQ,EAAD,EAASC,IAAaC,EAAAA,EAAAA,UAAS,IAE/B,EAAClB,EAAD,EAAcmB,IAAYC,EAAAA,EAAAA,YAAWd,EAAS,IAapD,OAXAe,EAAAA,EAAAA,YAAU,KAAO,IAAD,EACd,MAAMC,EAAgB,UAAGxB,EAAiBH,cAApB,QAA8B,GAC9CqB,EACJM,EAAiBC,OAAS,EACtBD,EAAiBA,EAAiBC,OAAS,GAAGC,GAAK,EACnD,EACNP,EAAUD,GAEVG,EAAS,CAAET,KAAM,OAAQC,MAAOW,MAC/B,IAGD,gBAAC7B,EAAwBgC,SAAzB,CAAkC5C,MAAOiB,GACvC,gBAAC,IAAD,KACE,gBAAC,IAAD,MACA,uBAAKf,UD5EY,oCC6EdiB,EAAY0B,KAAI,CAACzC,EAAM8B,IACtB,gBAAC,EAAD,CACE9B,KAAMA,EACNH,OAAQ6C,GACNR,EAAS,CAAET,KAAM,SAAUE,MAAOG,EAAG9B,KAAM0C,IAE7CzC,OAAQ,IAAMiC,EAAS,CAAET,KAAM,SAAUE,MAAOG,IAChDa,IAAK3C,EAAKuC,OAGd,0BACEzC,UDvFc,oCCwFdC,QAAS,KACPmC,EAAS,CACPT,KAAM,SACNzB,KAAM,CAAEuC,GAAIR,EAAQ5B,MAAO,GAAIP,MAAO,KAExCoC,EAAUD,EAAS","sources":["webpack://multi-counter/./src/components/counter.tsx","webpack://multi-counter/./src/styles/components/counter.module.css","webpack://multi-counter/./src/components/counterWithLabel.tsx","webpack://multi-counter/./src/styles/components/counterWithLabel.module.css","webpack://multi-counter/./src/contexts/storeContext.ts","webpack://multi-counter/./src/modules/localStorage.ts","webpack://multi-counter/./src/styles/pages/index.module.css","webpack://multi-counter/./src/pages/index.tsx"],"sourcesContent":["import React from \"react\"\nimport * as styles from \"~/styles/components/counter.module.css\"\n\ntype Props = {\n  value?: number\n  update: (value: number) => void\n}\n\nconst Counter: React.FC<Props> = ({ value = 0, update }) => {\n  const decrement = () => {\n    if (value <= 0) {\n      return\n    }\n    update(value - 1)\n  }\n  const increment = () => {\n    update(value + 1)\n  }\n\n  return (\n    <div className={styles.counter}>\n      <button className={styles.decrementButton} onClick={decrement}></button>\n      <span className={styles.value}>{value}</span>\n      <button className={styles.incrementButton} onClick={increment}></button>\n    </div>\n  )\n}\n\nexport default Counter\n","// extracted by mini-css-extract-plugin\nexport var counter = \"counter-module--counter--2Dv6q\";\nexport var decrementButton = \"counter-module--decrementButton--3KpC6\";\nexport var incrementButton = \"counter-module--incrementButton--d5zmp\";\nexport var value = \"counter-module--value--ygrTP\";","import React from \"react\"\nimport type { CounterProps } from \"~/contexts/storeContext\"\nimport * as styles from \"~/styles/components/counterWithLabel.module.css\"\nimport Counter from \"./counter\"\n\ntype Props = {\n  prop: CounterProps\n  update: (prop: CounterProps) => void\n  remove: () => void\n}\n\nconst CounterWithLabel: React.FC<Props> = ({ prop, update, remove }) => {\n  return (\n    <div className={styles.counterWithLabel}>\n      <input\n        className={styles.label}\n        defaultValue={prop.label}\n        placeholder={\"カウンター名\"}\n        onInput={e => {\n          update({ ...prop, label: e.currentTarget.value })\n        }}\n      />\n      <div className={styles.counterRow}>\n        <Counter\n          value={prop.value}\n          update={value => {\n            update({ ...prop, value })\n          }}\n        />\n      </div>\n      <button className={styles.closeButton} onClick={() => remove()}></button>\n    </div>\n  )\n}\n\nexport default CounterWithLabel\n","// extracted by mini-css-extract-plugin\nexport var counterWithLabel = \"counterWithLabel-module--counterWithLabel--39Zi7\";\nexport var label = \"counterWithLabel-module--label--2P_Sz\";\nexport var counterRow = \"counterWithLabel-module--counterRow--2D_g6\";\nexport var closeButton = \"counterWithLabel-module--closeButton--3Koff\";","import { createContext } from \"react\"\n\nexport type Store<T> = {\n  load: () => T | null\n  save: (v: T) => void\n}\n\nexport type CounterProps = {\n  id: number\n  label: string\n  value: number\n}\n\nexport type CounterListStore = Store<CounterProps[]>\n\nexport const CounterListStoreContext = createContext<CounterListStore>({\n  load: () => null,\n  save: () => {},\n})\n","import type { CounterListStore, CounterProps } from \"~/contexts/storeContext\"\n\nconst counterListKey = \"counter-list\"\n\nexport const counterListStore: CounterListStore = {\n  load: () => {\n    if (typeof localStorage === \"undefined\") {\n      return null\n    }\n\n    const counterList = localStorage.getItem(counterListKey)\n    if (!counterList) {\n      return null\n    }\n    return JSON.parse(counterList)\n  },\n  save: (counterList: CounterProps[]) => {\n    if (typeof localStorage === \"undefined\") {\n      return\n    }\n\n    localStorage.setItem(counterListKey, JSON.stringify(counterList))\n  },\n}\n","// extracted by mini-css-extract-plugin\nexport var counterList = \"index-module--counterList--2lrXi\";\nexport var appendButton = \"index-module--appendButton--2Vm-b\";","import type { PageProps } from \"gatsby\"\nimport React, { useEffect, useReducer, useState } from \"react\"\nimport CounterWithLabel from \"~/components/counterWithLabel\"\nimport type { CounterProps } from \"~/contexts/storeContext\"\nimport { CounterListStoreContext } from \"~/contexts/storeContext\"\nimport { counterListStore } from \"~/modules/localStorage\"\nimport * as styles from \"~/styles/pages/index.module.css\"\nimport Layout from \"../components/layout\"\nimport Seo from \"../components/seo\"\n\ntype Action =\n  | {\n      type: \"init\"\n      props: CounterProps[]\n    }\n  | {\n      type: \"append\"\n      prop: CounterProps\n    }\n  | {\n      type: \"update\"\n      index: number\n      prop: CounterProps\n    }\n  | {\n      type: \"remove\"\n      index: number\n    }\n\nconst reducer = (state: CounterProps[], action: Action): CounterProps[] => {\n  let newState: CounterProps[]\n  switch (action.type) {\n    case \"init\":\n      return action.props\n\n    case \"append\":\n      newState = [...state, action.prop]\n      counterListStore.save(newState)\n      return newState\n\n    case \"update\":\n      newState = [...state]\n      newState[action.index] = action.prop\n      counterListStore.save(newState)\n      return newState\n\n    case \"remove\":\n      newState = state.filter((_, i) => i !== action.index)\n      counterListStore.save(newState)\n      return newState\n\n    default:\n      const _: never = action\n      return _\n  }\n}\n\nconst IndexPage: React.FC<PageProps> = () => {\n  const [nextId, setNextId] = useState(0)\n\n  const [counterList, dispatch] = useReducer(reducer, [])\n\n  useEffect(() => {\n    const savedCounterList = counterListStore.load() ?? []\n    const nextId =\n      savedCounterList.length > 0\n        ? savedCounterList[savedCounterList.length - 1].id + 1\n        : 0\n    setNextId(nextId)\n\n    dispatch({ type: \"init\", props: savedCounterList })\n  }, [])\n\n  return (\n    <CounterListStoreContext.Provider value={counterListStore}>\n      <Layout>\n        <Seo />\n        <div className={styles.counterList}>\n          {counterList.map((prop, i) => (\n            <CounterWithLabel\n              prop={prop}\n              update={newProp =>\n                dispatch({ type: \"update\", index: i, prop: newProp })\n              }\n              remove={() => dispatch({ type: \"remove\", index: i })}\n              key={prop.id}\n            />\n          ))}\n          <button\n            className={styles.appendButton}\n            onClick={() => {\n              dispatch({\n                type: \"append\",\n                prop: { id: nextId, label: \"\", value: 0 },\n              })\n              setNextId(nextId + 1)\n            }}\n          ></button>\n        </div>\n      </Layout>\n    </CounterListStoreContext.Provider>\n  )\n}\n\nexport default IndexPage\n"],"names":["value","update","className","onClick","prop","remove","defaultValue","label","placeholder","onInput","e","currentTarget","CounterListStoreContext","createContext","load","save","counterListKey","counterListStore","localStorage","counterList","getItem","JSON","parse","setItem","stringify","reducer","state","action","newState","type","props","index","filter","_","i","nextId","setNextId","useState","dispatch","useReducer","useEffect","savedCounterList","length","id","Provider","map","newProp","key"],"sourceRoot":""}